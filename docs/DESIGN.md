# ToDoアプリ 設計書

## 1. 要件一覧

| ID | 要件 | 優先度 | 備考 |
|----|------|--------|------|
| R1 | Todoを1件追加できる | 必須 | テキスト入力 + 追加ボタン |
| R2 | Todo一覧を表示できる | 必須 | 追加順で表示 |
| R3 | Todoの完了/未完了を切り替えられる | 必須 | チェックでトグル |
| R4 | Todoを1件削除できる | 必須 | 削除ボタンで削除 |
| R5 | データを永続化する | 必須 | ブラウザの localStorage を使用 |
| R6 | 画面は1ページで完結する | 必須 | SPA または静的HTMLの単一画面 |

**意図的に含めない機能（最小限のため）**
- 編集（追加し直し・削除で代替）
- 期限・優先度・カテゴリ
- 複数ユーザー・認証

---

## 2. 画面構成

```
┌─────────────────────────────────────────┐
│  ToDo アプリ                             │
├─────────────────────────────────────────┤
│  [ 入力欄                    ] [追加]   │
├─────────────────────────────────────────┤
│  □ 牛乳を買う                      [×]  │
│  ■ レポートを書く                  [×]  │  ← 完了は打ち消し線などで表現
│  □ ジョギングする                 [×]  │
├─────────────────────────────────────────┤
│  （オプション: 未完了 3 件）             │
└─────────────────────────────────────────┘
```

- **ヘッダ**: アプリタイトル
- **入力エリア**: 1行テキスト + 「追加」ボタン
- **リストエリア**: 各Todo = チェックボックス + ラベル + 削除ボタン
- **フッタ（任意）**: 未完了件数などの表示

**画面数**: 1画面のみ。遷移なし。

---

## 3. データ構造

### 3.1 Todo 1件の形（フロント・ストレージ共通）

```ts
interface TodoItem {
  id: string;        // 一意（UUID または 日時+乱数）
  title: string;     // 表示テキスト（空は許可しない）
  completed: boolean;
  createdAt: string;  // ISO8601（並び順・デバッグ用）
}
```

### 3.2 アプリ全体の状態

```ts
interface TodoState {
  items: TodoItem[];
}
```

### 3.3 永続化（localStorage）

- **キー**: 固定文字列（例: `todo-app-v1`）
- **値**: `JSON.stringify(TodoState)`
- 読み込み時: 起動時に localStorage から復元。不正JSONは空配列として扱う。

### 3.4 設計上の注意

- **id**: クライアント生成で一意にし、リストの key や削除の指定に使用。
- **createdAt**: 並び順の基準とし、将来のソート拡張に備える。

---

## 4. 実装ステップ

### Phase 0: 環境準備
1. プロジェクト初期化（npm/pnpm + TypeScript）
2. テストフレームワーク導入（Vitest または Jest）
3. ディレクトリ構成の作成

### Phase 1: データ層（ビジネスロジック）
1. `TodoItem` / `TodoState` の型定義
2. ストアまたはモデル: 追加・一覧取得・完了トグル・削除・永続化
3. データ層の単体テスト（永続化はモックまたは in-memory）

### Phase 2: UI層
1. HTML の骨組み（入力・リスト・ボタン）
2. イベントハンドラで「追加・トグル・削除」をストアに反映
3. ストアの変更を検知してDOMを更新（素JSなら subscribe/emit、フレームワークなら state 更新）

### Phase 3: 結合・永続化
1. 起動時に localStorage から復元
2. 変更のたびに localStorage へ保存
3. 結合テストまたは E2E で「追加 → リロード → 一覧に残る」を確認

### Phase 4: 仕上げ
1. エッジケース（空入力で追加しない、不正データのフォールバック）のテスト追加
2. 可読性のためのコメント・ファイル分割の見直し
3. README に起動方法・テスト方法を記載

---

## 技術スタック案（未確定時）

- **言語**: TypeScript
- **ランタイム**: ブラウザ（バンドル: Vite など）
- **UI**: バニラJS + DOM 操作、または React/Vue の軽量利用
- **テスト**: Vitest（単体） + (必要なら) Playwright（E2E）

初学者向けにするなら、まずは **TypeScript + Vite + バニラJS** で進め、必要になったら React 等に寄せる構成を推奨。
